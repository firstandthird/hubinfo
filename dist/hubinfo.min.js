/*!
  * hubInfo - a github repo widget 
  * v0.0.1
  * https://github.com/jgallen23/hubinfo
  * copyright JGA 2012
  * MIT License
  */
!function(a){var b=function(b,c,d){a.ajax({url:"https://api.github.com/repos/"+b+"/"+c,dataType:"jsonp",success:function(a){if(a.data.message=="Not Found")throw new Error("Invalid user or repo");d(a.data)}})},c=function(b,c,d){a.ajax({url:"http://github.com/api/v2/json/commits/list/"+b+"/"+c+"/master",dataType:"jsonp",success:function(a){var b=a.commits[0];d(b)}})},d=function(a,d,e){var f=0,g=2,h,i,j=function(){f==g&&e(h,i)};b(a,d,function(a){f++,h=a,j()}),c(a,d,function(a){f++,i=a,j()})},e=function(a){if(typeof a=="string"){var b=a.split("T")[0].split("-");a=new Date(b[0],b[1]-1,b[2])}var c=(new Date).getTime(),d=c-a.getTime(),e=d/1e3,f=Math.floor(d/864e5);return f===0?"today":f>30?Math.floor(f/30)+" month(s) ago":f+" day(s) ago"};a.fn.hubInfo=function(b){var c=a.extend({},a.fn.hubInfo.defaults,b),f=this;return d(c.user,c.repo,function(b,d){c.debug&&console.log(data),f.each(function(f,g){var h=a(c.template);h.find(".repo-lang").html(b.language).end().find(".repo-watchers").html(b.watchers).attr("href",b.html_url).end().find(".repo-forks").html(b.forks).attr("href",b.html_url).end().find(".repo-name").html(b.name).attr("href",b.html_url).end().find(".repo-commit-message").html(d.message).attr("href","http://github.com"+d.url).end().find(".repo-commit-date span").html(e(d.committed_date)).end();var i=a(g);i.html(h)})}),f},a.fn.hubInfo.defaults={user:"",repo:"",debug:!1,template:['<div class="github-repo">','<div class="repo-header">','<div class="repo-stats">','<span class="repo-lang"></span>','<a class="repo-watchers"></a>','<a class="repo-forks"></a>',"</div>","<div>",'<a class="repo-name"></a>',"</div>","</div>",'<div class="repo-commit">','<a class="repo-commit-message"></a>','<div class="repo-commit-date">committed <span></span></div>',"</div>","</div>"].join("")}}(jQuery)